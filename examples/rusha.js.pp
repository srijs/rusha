#define READ_INT32BE(j)\
    H[i+j<<2>>2]

#define DO(j,y0,y1,y2,y3,y4, op, c)\
    y4 = ((y0 << 5 | y0 >>> 27) + (op) |0)+\
         ((y4 + (H[k+j<<2>>2]|0) ) + (c) |0) |0;\
    y1 = y1 << 30 | y1 >>> 2

#define DO_00_15(j,y0,y1,y2,y3,y4)\
    H[k+j<<2>>2] = READ_INT32BE(j);\
    DO(j,y0,y1,y2,y3,y4, y1 & y2 | ~y1 & y3, 1518500249);

#define DO_N(j, y0,y1,y2,y3,y4, op, c)\
    t0 = H[k+j-3<<2>>2] ^ H[k+j-8<<2>>2] ^ H[k+j-14<<2>>2] ^ H[k+j-16<<2>>2];\
    H[k+j<<2>>2] = t0 << 1 | t0 >>> 31;\
    DO(j,y0,y1,y2,y3,y4,op,c);

#define DO_16_19(j,y0,y1,y2,y3,y4)\
    DO_N(j, y0,y1,y2,y3,y4, y1 & y2 | ~y1 & y3, 1518500249);
#define DO_20_39(j,y0,y1,y2,y3,y4)\
    DO_N(j, y0,y1,y2,y3,y4, y1 ^ y2 ^ y3, 1859775393);
#define DO_40_59(j,y0,y1,y2,y3,y4)\
    DO_N(j, y0,y1,y2,y3,y4, y1 & y2 | y1 & y3 | y2 & y3, -1894007588);
#define DO_60_79(j,y0,y1,y2,y3,y4)\
    DO_N(j, y0,y1,y2,y3,y4, y1 ^ y2 ^ y3, -899497514);

        DO_00_15(0,y0,y1,y2,y3,y4)
        DO_00_15(1,y4,y0,y1,y2,y3)
        DO_00_15(2,y3,y4,y0,y1,y2)
        DO_00_15(3,y2,y3,y4,y0,y1)
        DO_00_15(4,y1,y2,y3,y4,y0)
        DO_00_15(5,y0,y1,y2,y3,y4)
        DO_00_15(6,y4,y0,y1,y2,y3)
        DO_00_15(7,y3,y4,y0,y1,y2)
        DO_00_15(8,y2,y3,y4,y0,y1)
        DO_00_15(9,y1,y2,y3,y4,y0)
        DO_00_15(10,y0,y1,y2,y3,y4)
        DO_00_15(11,y4,y0,y1,y2,y3)
        DO_00_15(12,y3,y4,y0,y1,y2)
        DO_00_15(13,y2,y3,y4,y0,y1)
        DO_00_15(14,y1,y2,y3,y4,y0)
        DO_00_15(15,y0,y1,y2,y3,y4)

        DO_16_19(16,y4,y0,y1,y2,y3)
        DO_16_19(17,y3,y4,y0,y1,y2)
        DO_16_19(18,y2,y3,y4,y0,y1)
        DO_16_19(19,y1,y2,y3,y4,y0)

        DO_20_39(20,y0,y1,y2,y3,y4)
        DO_20_39(21,y4,y0,y1,y2,y3)
        DO_20_39(22,y3,y4,y0,y1,y2)
        DO_20_39(23,y2,y3,y4,y0,y1)
        DO_20_39(24,y1,y2,y3,y4,y0)
        DO_20_39(25,y0,y1,y2,y3,y4)
        DO_20_39(26,y4,y0,y1,y2,y3)
        DO_20_39(27,y3,y4,y0,y1,y2)
        DO_20_39(28,y2,y3,y4,y0,y1)
        DO_20_39(29,y1,y2,y3,y4,y0)
        DO_20_39(30,y0,y1,y2,y3,y4)
        DO_20_39(31,y4,y0,y1,y2,y3)
        DO_20_39(32,y3,y4,y0,y1,y2)
        DO_20_39(33,y2,y3,y4,y0,y1)
        DO_20_39(34,y1,y2,y3,y4,y0)
        DO_20_39(35,y0,y1,y2,y3,y4)
        DO_20_39(36,y4,y0,y1,y2,y3)
        DO_20_39(37,y3,y4,y0,y1,y2)
        DO_20_39(38,y2,y3,y4,y0,y1)
        DO_20_39(39,y1,y2,y3,y4,y0)

        DO_40_59(40,y0,y1,y2,y3,y4)
        DO_40_59(41,y4,y0,y1,y2,y3)
        DO_40_59(42,y3,y4,y0,y1,y2)
        DO_40_59(43,y2,y3,y4,y0,y1)
        DO_40_59(44,y1,y2,y3,y4,y0)
        DO_40_59(45,y0,y1,y2,y3,y4)
        DO_40_59(46,y4,y0,y1,y2,y3)
        DO_40_59(47,y3,y4,y0,y1,y2)
        DO_40_59(48,y2,y3,y4,y0,y1)
        DO_40_59(49,y1,y2,y3,y4,y0)
        DO_40_59(50,y0,y1,y2,y3,y4)
        DO_40_59(51,y4,y0,y1,y2,y3)
        DO_40_59(52,y3,y4,y0,y1,y2)
        DO_40_59(53,y2,y3,y4,y0,y1)
        DO_40_59(54,y1,y2,y3,y4,y0)
        DO_40_59(55,y0,y1,y2,y3,y4)
        DO_40_59(56,y4,y0,y1,y2,y3)
        DO_40_59(57,y3,y4,y0,y1,y2)
        DO_40_59(58,y2,y3,y4,y0,y1)
        DO_40_59(59,y1,y2,y3,y4,y0)

        DO_60_79(60,y0,y1,y2,y3,y4)
        DO_60_79(61,y4,y0,y1,y2,y3)
        DO_60_79(62,y3,y4,y0,y1,y2)
        DO_60_79(63,y2,y3,y4,y0,y1)
        DO_60_79(64,y1,y2,y3,y4,y0)
        DO_60_79(65,y0,y1,y2,y3,y4)
        DO_60_79(66,y4,y0,y1,y2,y3)
        DO_60_79(67,y3,y4,y0,y1,y2)
        DO_60_79(68,y2,y3,y4,y0,y1)
        DO_60_79(69,y1,y2,y3,y4,y0)
        DO_60_79(70,y0,y1,y2,y3,y4)
        DO_60_79(71,y4,y0,y1,y2,y3)
        DO_60_79(72,y3,y4,y0,y1,y2)
        DO_60_79(73,y2,y3,y4,y0,y1)
        DO_60_79(74,y1,y2,y3,y4,y0)
        DO_60_79(75,y0,y1,y2,y3,y4)
        DO_60_79(76,y4,y0,y1,y2,y3)
        DO_60_79(77,y3,y4,y0,y1,y2)
        DO_60_79(78,y2,y3,y4,y0,y1)
        DO_60_79(79,y1,y2,y3,y4,y0)
